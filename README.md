# ComfyUI-Phantom-Tool
## 👻幻影工具 - ComfyUI 实用节点插件
* 一套面向ComfyUI的多功能实用节点集合，包含数值计算、文本处理、视频帧提取、数据选择等高频使用功能，适配多类型输入，提供友好的中文交互体验。

![node](https://github.com/user-attachments/assets/7813ea1d-15a7-4f98-9a39-bad5fec58d85)


## 特别申明：
* 本插件的所有节点均由AI开发，提供者（@幻影）不懂代码，如不好用或有BUG请删除。

## 功能说明：

#### 数值计算器
* 预设模式：关闭「使用计算公式」，选择「最大值 / 最小值 / 求和 / 平均值」，连接 a/b/c 任意输入端口即可自动计算;
* 自定义公式模式：开启「使用计算公式」，输入支持 a/b/c 变量的表达式（如(a+b)*c），自动执行计算;
* 支持输入类型：数字、布尔值、字符串（数字）、图像（取宽度）、列表 / 元组 / 字典（提取数值）等。

#### TXT 文件批量加载
* 输入 TXT 文件所在文件夹路径（如D:\txt_files）；  
* 「文件索引」填-1加载路径下所有 TXT 文件，填具体数字（如 0/1/2）加载指定索引的文件；
* 输出为文件内容，含读取失败提示。  


#### 文本合并
* 文本 1 / 文本 2 为必填端口，文本 3 / 文本 4 为可选端口；  
* 合并模式：  
  * 追加模式：用逗号分隔（如文本1,文本2）
  * 拼接模式：直接拼接（如文本1文本2）
  * 换行：单换行分隔（文本1\n文本2）  
  * 空一行：双换行分隔（文本1\n\n文本2）  


#### 倍数修改器
* 输入任意类型数值（数字 / 字符串 / 布尔值等）；
* 选择目标倍数（8/16/32/64/128/256/512）；
* 输出为最接近输入值的指定倍数，且保持原输入类型（如输入字符串 "10"，选择 8 倍，输出 "8"）。

#### 任意选择器
* 输入任意 0 / 输入任意 1 为必填端口，输入任意 2-5 为可选端口；
* 「选择输出索引」填 0-5，对应输出指定端口的数据；
* 可选端口未连接时会返回明确的错误提示。

#### 视频首尾帧获取
* 支持两种输入方式：  
    1、直接输入视频文件路径（mp4/avi/mov/mkv/flv），文件路径如D:\video_files\video_name.mp4）；  
    2、连接 ComfyUI 的 VideoFromFile/VideoFromComponents 节点输出；  
* 自动提取首尾帧并转换为 ComfyUI 标准 IMAGE 格式，支持预览。

## 注意事项
1、数值计算器的自定义公式仅支持 a/b/c 变量，请勿输入恶意代码；  
2、视频首尾帧获取节点需确保视频文件路径有效，且有读取权限；  
3、所有节点均支持中文参数名，建议在 ComfyUI 中使用中文界面以获得最佳体验；  
4、若输入类型转换失败，节点会返回兜底值（如 0 / 空字符串）并打印错误日志。  

## 安装步骤
#### 方法一：
1、下载本插件，将文件夹放入“ComfyUI\custom_nodes”目录下；  
2、重启 ComfyUI，在节点面板的「👻幻影工具」分类下即可看到所有节点。

#### 方法二：
1、在“ComfyUI\custom_nodes”文件夹右键；  
2、选择在终端中打开（或者文件夹地址栏输入cmd）；  
3、输入git clone https://github.com/wer2288/ComfyUI-Phantom-Tool.git并回车；  
4、重启 ComfyUI，在节点面板的「👻幻影工具」分类下即可看到所有节点。
